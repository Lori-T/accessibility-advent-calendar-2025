{% extends "govuk-prototype-kit/layouts/govuk-branded.njk" %}
{% from "govuk/components/service-navigation/macro.njk" import govukServiceNavigation %}

{% block beforeContent %}
  {{ govukPhaseBanner({
    tag: { text: "Training" },
    html: 'This is not a real service ‚Äì this is for training purposes only. You can <a class="govuk-link" href="mailto:lorithomson@hotmail.co.uk">give your feedback on this resource by email</a> or <a href="https://www.surveymonkey.com/r/8JZX5KD" class="govuk-link" target="_blank" rel="noopener noreferrer"> feedback survey (opens in a new tab)</a>.'
  }) }}
{% endblock %}

{% block head %}
  {{ super() }}

  <link rel="icon" href="" type="image/x-icon">
  <link rel="shortcut icon" href="" type="image/x-icon">

  <link rel="icon"
        type="image/svg+xml"
        href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">üéÖ</text></svg>'>
{% endblock %}

{% block header %}
<header class="govuk-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-width-container header-with-toggle">

    <!-- Logo -->
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <img src="{{ asset_path }}images/DEA_logo_full.png"
             alt="Department for Elfish Affairs"
             class="santa-logo">
      </a>
    </div>

    <!-- Service name -->
    {% if serviceName %}
    <div class="govuk-header__content">
      <a href="/" class="govuk-header__link govuk-header__service-name">
        {{ serviceName }}
      </a>
    </div>
    {% endif %}

    <!-- FESTIVE SWITCH -->
    <button id="festive-toggle" class="festive-toggle-combo" aria-pressed="false">
      <span class="switch-track">
        <span class="switch-knob"></span>
      </span>
      <span class="switch-text">Festive effects</span>
    </button>

  </div>
</header>
{% endblock %}

{% block stylesheets %}
  {{ super() }}

<script>
document.addEventListener("DOMContentLoaded", function () {
  const body = document.body;
  const btn = document.getElementById("festive-toggle");
  const label = btn.querySelector(".switch-text");

  if (!btn) return;

  function updateState(isOn) {
    if (isOn) {
      body.classList.remove("no-festive");
      btn.setAttribute("aria-pressed", "true");
      btn.classList.add("is-on");

      // ‚ùÑÔ∏è Emoji when ON
      label.textContent = "‚ùÑÔ∏è Festive effects off";

      localStorage.setItem("festiveEffects", "on");
    } else {
      body.classList.add("no-festive");
      btn.setAttribute("aria-pressed", "false");
      btn.classList.remove("is-on");

      // üéÑ Emoji when OFF
      label.textContent = "üéÑ Festive effects on";

      localStorage.setItem("festiveEffects", "off");
    }
  }

  // Restore saved setting
  const pref = localStorage.getItem("festiveEffects");
  updateState(pref !== "off");

  // Toggle on click
  btn.addEventListener("click", function (event) {
    event.stopPropagation();
    const isOn = btn.getAttribute("aria-pressed") === "true";
    updateState(!isOn);
  });
});

</script>

{% endblock %}

{% block content %}
  <div class="govuk-width-container">

    {% block beforeDayContent %}{% endblock %}

    {{ super() }}

    {% block dayNavigation %}{% endblock %}

  </div>
{% endblock %}


{% block footer %}
  {{ govukFooter({
    meta: {
      items: [
        { href: "/manage-prototype/clear-data", text: "Clear data" },
        { href: "/sitemap", text: "Site map" },
              { href: "/accessibility", text: "Accessibility statement" },
        { href: "/about", text: "About this service" },
        { href: "https://www.surveymonkey.com/r/8JZX5KD", text: "Feedback survey" },
        { href: "https://github.com/Lori-T/accessibility-advent-2025", text: "GitHub" }
      ],
      visuallyHiddenTitle: "Footer links"
    },
    contentLicence: { text: "¬© 2025 Department for Elfish Affairs" }
  }) }}
{% endblock %}
