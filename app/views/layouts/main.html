{% extends "govuk-prototype-kit/layouts/govuk-branded.njk" %}
{% from "govuk/components/service-navigation/macro.njk" import govukServiceNavigation %}

{% block beforeContent %}
  {{ govukPhaseBanner({
    tag: { text: "Training" },
    html: 'This is not a real service ‚Äì this is for training purposes only. You can give your feedback on this resource by <a class="govuk-link" href="mailto:lorithomson@hotmail.co.uk">email</a> or <a href="https://www.surveymonkey.com/r/8JZX5KD" class="govuk-link" target="_blank" rel="noopener noreferrer">survey</a>.'
  }) }}
{% endblock %}
{% block head %}
  {{ super() }}

  <!-- Force remove default GOV.UK favicon -->
  <link rel="icon" href="" type="image/x-icon">
  <link rel="shortcut icon" href="" type="image/x-icon">

  <!-- üéÖ Santa emoji favicon (overrides GOV.UK) -->
  <link rel="icon"
        type="image/svg+xml"
        href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">üéÖ</text></svg>'>
{% endblock %}

{% block header %}
  <header class="govuk-header" role="banner" data-module="govuk-header">
    <div class="govuk-header__container govuk-width-container">
      <div class="govuk-header__logo">
        <a href="/" class="govuk-header__link govuk-header__link--homepage">
          <img src="{{ asset_path }}images/DEA_logo_full.png"
               alt="Department for Elfish Affairs"
               class="santa-logo"
               width="250" height="60">
        </a>
      </div>
      {% if serviceName %}
      <div class="govuk-header__content">
        <a href="/" class="govuk-header__link govuk-header__service-name">
          {{ serviceName }}
        </a>
      </div>
      {% endif %}
    </div>
  </header>
{% endblock %}

{% block stylesheets %}
  {{ super() }}
  <style>
    :root {
      --festive-red: #b30000;
      --festive-green: #0b6b0b;
      --festive-gold: #f5c542;
      --midnight-blue: #0c1a3d;
    }

    html, body {
      font-family: Arial, Helvetica, sans-serif !important;
      background: linear-gradient(to bottom, #ffffff 0%, #e3f0ff 100%);
    }

 /* ===============================
   HEADER ‚Äî DEPARTMENT FOR ELFISH AFFAIRS
   =============================== */
.govuk-header {
  background-color: var(--festive-red) !important;
  border-bottom: 4px solid var(--festive-green) !important;
  background-image: url("/public/images/snowy-header.png");
  background-repeat: no-repeat;
  background-position: right bottom;
  background-size: contain;
  position: relative;
  z-index: 5;
}

/* Remove GOV.UK blue strip & default logo background */
.govuk-header__container {
  background: none !important;
}

/* Hide any remaining GOV.UK crown, text or blue fill */
.govuk-header__logotype,
.govuk-header__logotype-crown,
.govuk-header__logotype-text {
  display: none !important;
  background: none !important;
  fill: none !important;
  color: inherit !important;
  border: none !important;
  box-shadow: none !important;
}

/* Logo container tidy-up */
.govuk-header__logo {
  background: none !important;
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
  box-shadow: none !important;
}

/* Header layout alignment */
.govuk-header__container.govuk-width-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

/* Service name link */
.govuk-header__link.govuk-header__service-name {
  color: #ffffff !important;
  font-weight: 600 !important;
  text-decoration: none !important;
}

/* Hover/focus gold glow */
.govuk-header__link.govuk-header__service-name:hover,
.govuk-header__link.govuk-header__service-name:focus {
  color: var(--festive-gold) !important;
  text-shadow: 0 0 6px var(--festive-gold);
}

/* Santa logo ‚Äì soft golden glow */
.santa-logo {
  display: block;
  max-height: 120px;
  object-fit: contain;
  filter:
    drop-shadow(0 0 2px rgba(255,255,255,0.5))
    drop-shadow(0 0 8px var(--festive-gold));
}



    /* Footer */
    .govuk-footer {
      background: var(--midnight-blue) !important;
      border-top: 4px solid var(--festive-red) !important;
      color: #fff !important;
      background-image: url("/public/images/snowy-footer.png");
      background-repeat: repeat-x;
      background-position: bottom center;
      background-size: auto 90px;
      padding-top: 2rem;
      padding-bottom: 2rem !important;
    }

    .govuk-footer a { color: var(--festive-gold) !important; }
    .govuk-footer a:hover { color: #fff !important; }

    .govuk-footer__licence-logo,
    .govuk-footer__copyright-logo,
    .govuk-footer__crown,
    .govuk-footer__logo { display: none !important; }

    .govuk-footer__meta { text-align: center; }

    /* Snow */
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-image: url("{{ asset_path }}images/snowflake.png");
      background-repeat: repeat;
      background-size: 200px;
      opacity: 0.15;
      animation: snowfall 40s linear infinite;
      pointer-events: none;
      z-index: 0;
    }

    @keyframes snowfall {
      0% { background-position: 0 0; }
      100% { background-position: 0 1000px; }
    }

    /* Lights */
    .govuk-header::after {
      content: "";
      display: block;
      width: 100%;
      height: 12px;
      background-image:
        radial-gradient(circle at 10px 6px, var(--festive-gold) 2px, transparent 3px),
        radial-gradient(circle at 30px 6px, var(--festive-red) 2px, transparent 3px),
        radial-gradient(circle at 50px 6px, var(--festive-green) 2px, transparent 3px),
        radial-gradient(circle at 70px 6px, var(--festive-gold) 2px, transparent 3px),
        radial-gradient(circle at 90px 6px, var(--festive-red) 2px, transparent 3px);
      background-size: 100px 12px;
      animation: twinkle 2s ease-in-out infinite alternate;
      border-bottom: 2px solid var(--festive-green);
    }

    @keyframes twinkle {
      0% { filter: brightness(0.7); opacity: 0.8; }
      100% { filter: brightness(1.4); opacity: 1; }
    }

    /* Toggle button (floating) */
    #festive-toggle {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 9999;
      background-color: var(--festive-red) !important;
      border-color: darkred !important;
      color: #fff !important;
      box-shadow: 0 0 6px rgba(0, 0, 0, 0.4);
      transition: transform 0.2s ease-in-out;
    }

    #festive-toggle:hover {
      background-color: #990000 !important;
      transform: scale(1.05);
    }

    body.no-festive::before { display: none !important; }
    body.no-festive .govuk-header::after { display: none !important; }
  </style>
  <!-- Floating festive toggle button -->
  <button id="festive-toggle"
          class="govuk-button govuk-button--secondary"
          type="button"
          aria-pressed="false">
    üéÑ Turn off festive effects
  </button>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const body = document.body;
      const btn = document.getElementById('festive-toggle');
      if (!btn) return;

      // restore previous setting
      const pref = localStorage.getItem('festiveEffects');
      if (pref === 'off') {
        body.classList.add('no-festive');
        btn.textContent = '‚ùÑÔ∏è Turn on festive effects';
        btn.setAttribute('aria-pressed', 'false');
      }

      btn.addEventListener('click', function () {
        const active = !body.classList.contains('no-festive');
        if (active) {
          body.classList.add('no-festive');
          btn.textContent = '‚ùÑÔ∏è Turn on festive effects';
          btn.setAttribute('aria-pressed', 'false');
          localStorage.setItem('festiveEffects', 'off');
        } else {
          body.classList.remove('no-festive');
          btn.textContent = 'üéÑ Turn off festive effects';
          btn.setAttribute('aria-pressed', 'true');
          localStorage.setItem('festiveEffects', 'on');
        }
      });
    });
  </script>
{% endblock %}

{% block footer %}
  {{ govukFooter({
    meta: {
      items: [
        { href: "/manage-prototype/clear-data", text: "Clear data" },
        { href: "/tasklist", text: "View your reports" },
        { href: "/guidance", text: "How to spot Santa" },
        { href: "/accessibility", text: "Accessibility statement" },
        { href: "/about", text: "About this service" },
        { href: "https://www.surveymonkey.com/r/8JZX5KD", text: "Feedback survey" },
        { href: "https://github.com/Lori-T/record-an-elf-sighting", text: "GitHub" }
      ],
      visuallyHiddenTitle: "Footer links"
    },
    contentLicence: { text: "¬© 2025 Department for Elfish Affairs" }
  }) }}
{% endblock %}

